function log_object(e){var t="";for(var n in e)t+=n+": "+e[n]+"; ";console.log("object="+t)}function button_stacking(){console.log("click button_stacking");var e=$("#zaehler_chart").highcharts();$(e.series).each(function(e,t){this.visible&&0>$.inArray(t.name,visibleSeriesIndex)&&this.update({stacking:"normal"})})}function button_percent(){console.log("click button_percent");var e=$("#zaehler_chart").highcharts();$(e.series).each(function(e,t){this.visible&&0>$.inArray(t.name,visibleSeriesIndex)&&this.update({stacking:"percent"})})}function button_addSerie(){var e=$("#zaehler_chart").highcharts();$(e.series).each(function(t,n){if(this.visible&&"column"!=this.type&&0>$.inArray(n.name,visibleSeriesIndex)){visibleSeriesIndex.push(n.name),console.log("berechne: "+n.name);var r=new Array,i=this.data[0].y,a=0;$(this.data).each(function(e,t){a=Math.round(10*(t.y-i))/10,i=t.y,r.push([t.x,a])}),e.addSeries({name:"Verbrauch "+n.name,data:r,yAxis:1,type:"column",stack:1})}})}var visibleSeriesIndex=new Array;$(document).ready(function(){var e={chart:{zoomType:"xy",renderTo:"zaehler_chart"},title:{text:"Zählerwerte"},xAxis:{type:"datetime"},yAxis:[{title:{text:"Zählerstand in Kilowattstunden [KWh]"}},{title:{text:"Verbrauch pro Monat in Kilowattstunden [KWh]"},opposite:!0}],tooltip:{pointFormat:'<span style="color:{series.color}">{series.name}</span>: <b>{point.y} kWh</b> ({point.percentage:.0f}%)<br/>'},series:[]};$.getJSON("zaehlers/normiertewerte",function(t){e.series=t;var n=new Highcharts.Chart(e);n.series[0],$(n.series).each(function(){this.setVisible(!1,!1)})}),chart=new Highcharts.Chart({chart:{zoomType:"xy",renderTo:"stromwerte_chart"},lang:{decimalPoint:",",thousandsSep:".",numericSymbols:null},title:{text:"Zählerwerte"},xAxis:{type:"datetime"},yAxis:[{title:{text:"Zählerstand in Kilowattstunden [KWh]"}},{title:{text:"Verbrauch pro Monat in Kilowattstunden [KWh]"},opposite:!0},{title:{text:"Kosten pro Monat in Euro"},opposite:!0}],tooltip:{formatter:function(){var e="KWh";return this.series.name.match(/Kosten/)&&(e="€ "),this.series.name.match(/Verbrauch/)&&(e="KWh"),"<b>"+this.series.name+"</b>: "+Highcharts.numberFormat(this.y,1)+" "+e+" am "+Highcharts.dateFormat("%d.%m.%Y",this.x)}},legend:{layout:"vertical",align:"left",x:120,verticalAlign:"top",y:20,floating:!0,backgroundColor:"#FFFFFF"}}),$(".button").click(function(){var e,t,n,r=new Array,i=new Array,a=new Array,o=new Array,s=new Array,l=new Array,u=new Date,c=$(this).attr("id"),d=$(this).attr("kurzbezeichnung"),f=0,p=.26;$.getJSON("/zaehlers/"+c,function(h){n=h.zaehler.faktor,$.each(h.werte,function(d,h){h.zaehler_id==c&&(e=new Date(h.datum),anzahlTageimMonat=new Date(e.getYear(),e.getMonth()+1,0).getDate(),u=e-t,u/=864e5,o.push(e.getTime()),s.push(e.getTime()),l.push(e.getTime()),o.push(h.stand),s.push((h.stand-f)/u*anzahlTageimMonat),l.push((h.stand-f)/u*anzahlTageimMonat*p*n),r.push(o),i.push(s),a.push(l),f=h.stand,t=e,o=[],s=[],l=[])}),delete i[0],delete a[0],chart.addSeries({name:d,type:"spline",data:r.sort()}),chart.addSeries({name:"Verbrauch "+d,type:"column",yAxis:1,data:i.sort()}),chart.addSeries({name:"Kosten "+d,type:"column",yAxis:2,data:a.sort()})})})});